2026-01-31 17:19:53,798 [INFO] Experiment 11: Activation Patching (Causal Tracing)
2026-01-31 17:19:53,798 [INFO] Start: 2026-01-31T17:19:53.798690
2026-01-31 17:20:37,007 [INFO] Model: Qwen/Qwen2.5-1.5B-Instruct (28 layers), test_layers=[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26]
2026-01-31 17:20:37,007 [INFO] Testing positions: ['first_query_token']
2026-01-31 17:20:37,008 [INFO] 
==================================================
2026-01-31 17:20:37,008 [INFO] Task: uppercase
2026-01-31 17:20:37,008 [INFO] ==================================================
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.8` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:623: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `20` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
2026-01-31 17:20:51,956 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:20:51,957 [INFO] 
  Position: first_query_token
2026-01-31 17:21:17,471 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:21:42,452 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:22:08,428 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:22:32,795 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:22:57,876 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:23:23,419 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:23:49,033 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:24:16,528 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:24:43,312 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:25:09,734 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:25:35,238 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:26:00,517 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:26:25,910 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:26:54,465 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:26:54,465 [INFO] 
==================================================
2026-01-31 17:26:54,465 [INFO] Task: first_letter
2026-01-31 17:26:54,466 [INFO] ==================================================
2026-01-31 17:27:07,451 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:27:07,452 [INFO] 
  Position: first_query_token
2026-01-31 17:27:33,190 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:27:58,755 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:28:29,008 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:28:54,666 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:29:20,440 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:29:46,946 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:30:13,824 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:30:38,693 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:31:07,398 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:31:38,627 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:32:03,640 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:32:32,204 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:32:57,784 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:33:23,056 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:33:23,056 [INFO] 
==================================================
2026-01-31 17:33:23,056 [INFO] Task: repeat_word
2026-01-31 17:33:23,056 [INFO] ==================================================
2026-01-31 17:33:35,888 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:33:35,889 [INFO] 
  Position: first_query_token
2026-01-31 17:34:00,942 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:34:26,683 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:34:53,308 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:35:19,688 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:35:45,470 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:36:11,552 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:36:37,880 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:37:03,682 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:37:29,729 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:37:55,940 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:38:22,326 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:38:48,700 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:39:16,549 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:39:42,761 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:39:42,761 [INFO] 
==================================================
2026-01-31 17:39:42,762 [INFO] Task: length
2026-01-31 17:39:42,762 [INFO] ==================================================
2026-01-31 17:39:55,744 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:39:55,744 [INFO] 
  Position: first_query_token
2026-01-31 17:40:21,796 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:40:47,784 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:41:19,208 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:41:53,165 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:42:21,207 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:42:52,190 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:43:27,081 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:43:56,433 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:44:22,635 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:44:48,783 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:45:14,921 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:45:45,767 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:46:14,422 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:46:43,013 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:46:43,014 [INFO] 
==================================================
2026-01-31 17:46:43,014 [INFO] Task: linear_2x
2026-01-31 17:46:43,014 [INFO] ==================================================
2026-01-31 17:46:56,689 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:46:56,689 [INFO] 
  Position: first_query_token
2026-01-31 17:47:23,655 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:47:49,787 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:48:16,303 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:48:47,360 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:49:13,565 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:49:39,863 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:50:06,217 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:50:32,574 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:51:00,192 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:51:26,557 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:51:53,024 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:52:19,353 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:52:45,608 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:53:12,042 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:53:12,042 [INFO] 
==================================================
2026-01-31 17:53:12,042 [INFO] Task: sentiment
2026-01-31 17:53:12,042 [INFO] ==================================================
2026-01-31 17:53:25,141 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:53:25,141 [INFO] 
  Position: first_query_token
2026-01-31 17:53:51,423 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:54:18,723 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:54:45,279 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:55:12,950 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:55:39,431 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:56:05,827 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:56:32,284 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:56:58,812 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:57:25,494 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:57:52,147 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:58:19,048 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:58:45,856 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:59:12,285 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:59:41,093 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 17:59:41,093 [INFO] 
==================================================
2026-01-31 17:59:41,094 [INFO] Task: antonym
2026-01-31 17:59:41,094 [INFO] ==================================================
2026-01-31 17:59:54,359 [INFO]   Baseline accuracy: 0.00
2026-01-31 17:59:54,359 [INFO] 
  Position: first_query_token
2026-01-31 18:00:20,979 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:00:49,076 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:01:20,135 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:01:47,863 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:02:14,578 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:02:41,188 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:03:08,290 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:03:35,864 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:04:02,435 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:04:28,960 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:04:55,713 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:05:22,224 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:05:49,366 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:06:15,951 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:06:15,951 [INFO] 
==================================================
2026-01-31 18:06:15,951 [INFO] Task: pattern_completion
2026-01-31 18:06:15,951 [INFO] ==================================================
2026-01-31 18:06:29,328 [INFO]   Baseline accuracy: 0.00
2026-01-31 18:06:29,328 [INFO] 
  Position: first_query_token
2026-01-31 18:06:56,264 [INFO]     Layer  0: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:07:22,980 [INFO]     Layer  2: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:07:50,020 [INFO]     Layer  4: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:08:18,386 [INFO]     Layer  6: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:08:48,214 [INFO]     Layer  8: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:09:14,980 [INFO]     Layer 10: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:09:42,281 [INFO]     Layer 12: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:10:08,951 [INFO]     Layer 14: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:10:36,520 [INFO]     Layer 16: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:11:03,161 [INFO]     Layer 18: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:11:30,482 [INFO]     Layer 20: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:11:57,026 [INFO]     Layer 22: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:12:24,602 [INFO]     Layer 24: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:12:51,280 [INFO]     Layer 26: acc@noise5.0=0.00 disruption=0.00 
2026-01-31 18:12:51,281 [INFO] 
============================================================
2026-01-31 18:12:51,281 [INFO] CAUSAL IMPORTANCE HEATMAP (disruption at noise=5.0)
2026-01-31 18:12:51,281 [INFO] ============================================================
2026-01-31 18:12:51,281 [INFO] 
Position: first_query_token
2026-01-31 18:12:51,281 [INFO] Layer:      0      2      4      6      8     10     12     14     16     18     20     22     24     26
2026-01-31 18:12:51,281 [INFO] uppercase   :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,281 [INFO] first_letter:  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,281 [INFO] repeat_word :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,281 [INFO] length      :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,281 [INFO] linear_2x   :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,281 [INFO] sentiment   :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,282 [INFO] antonym     :  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,282 [INFO] pattern_completion:  0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00   0.00
2026-01-31 18:12:51,282 [INFO] 
============================================================
2026-01-31 18:12:51,282 [INFO] MOST CRITICAL LAYERS (mean disruption > 0.1)
2026-01-31 18:12:51,282 [INFO] ============================================================
2026-01-31 18:12:51,282 [INFO] 
first_query_token:
2026-01-31 18:12:51,287 [INFO] 
Results saved to results/qwen2.5-1.5b-instruct/exp11
2026-01-31 18:12:51,287 [INFO] Experiment 11 complete: 2026-01-31T18:12:51.287357
Loading Qwen/Qwen2.5-1.5B-Instruct...
Loaded on cuda:1. 28 layers, d_model=1536
