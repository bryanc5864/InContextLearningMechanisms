2026-01-31 18:26:50,587 [INFO] Experiment 23: Proper Statistics (N=50, CIs)
2026-01-31 18:26:50,587 [INFO] Start: 2026-01-31T18:26:50.587453
Loading meta-llama/Llama-3.2-3B-Instruct...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  6.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.12s/it]
2026-01-31 18:27:21,119 [INFO] Model: meta-llama/Llama-3.2-3B-Instruct, N=50, layers=[8, 12, 15, 17]
2026-01-31 18:27:21,120 [INFO] 
============================================================
2026-01-31 18:27:21,120 [INFO] Pair: uppercase -> first_letter
2026-01-31 18:27:21,120 [INFO] ============================================================
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
2026-01-31 18:28:42,039 [INFO]   L 8 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.00 [0.00,0.07]
2026-01-31 18:30:01,479 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:31:21,725 [INFO]   L 8 output_only : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 18:32:40,698 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 18:33:59,040 [INFO]   L12 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 18:35:19,638 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:36:39,967 [INFO]   L12 output_only : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 18:37:59,802 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 18:39:19,208 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.06 [0.02,0.16]
2026-01-31 18:40:38,254 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 18:41:58,635 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=0.06 [0.02,0.16]
2026-01-31 18:43:18,695 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.04 [0.01,0.13]
2026-01-31 18:44:39,297 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 18:46:00,441 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:47:19,998 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 18:48:40,315 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 18:48:40,315 [INFO] 
============================================================
2026-01-31 18:48:40,315 [INFO] Pair: uppercase -> repeat_word
2026-01-31 18:48:40,315 [INFO] ============================================================
2026-01-31 18:49:58,106 [INFO]   L 8 all_demo    : transfer=0.96 [0.87,0.99] preserve=0.00 [0.00,0.07]
2026-01-31 18:51:17,455 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:52:36,354 [INFO]   L 8 output_only : transfer=0.94 [0.84,0.98] preserve=0.00 [0.00,0.07]
2026-01-31 18:53:56,217 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:55:16,876 [INFO]   L12 all_demo    : transfer=0.26 [0.16,0.40] preserve=0.24 [0.14,0.37]
2026-01-31 18:56:37,520 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 18:57:56,965 [INFO]   L12 output_only : transfer=0.18 [0.10,0.31] preserve=0.06 [0.02,0.16]
2026-01-31 18:59:17,192 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:00:37,084 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:01:56,735 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:03:16,816 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:04:35,615 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:05:56,634 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:07:15,209 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:08:35,495 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:09:57,251 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:09:57,252 [INFO] 
============================================================
2026-01-31 19:09:57,252 [INFO] Pair: first_letter -> repeat_word
2026-01-31 19:09:57,252 [INFO] ============================================================
2026-01-31 19:11:18,259 [INFO]   L 8 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.52 [0.39,0.65]
2026-01-31 19:12:40,542 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:14:01,947 [INFO]   L 8 output_only : transfer=0.00 [0.00,0.07] preserve=0.34 [0.22,0.48]
2026-01-31 19:15:20,871 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:16:40,729 [INFO]   L12 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 19:18:01,518 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:19:20,955 [INFO]   L12 output_only : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 19:20:41,570 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:22:02,129 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:23:23,485 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:24:41,988 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:26:01,604 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:27:21,694 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:28:40,217 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:30:00,579 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:31:17,438 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:31:17,439 [INFO] 
============================================================
2026-01-31 19:31:17,439 [INFO] Pair: uppercase -> sentiment
2026-01-31 19:31:17,439 [INFO] ============================================================
2026-01-31 19:32:38,543 [INFO]   L 8 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 19:33:59,416 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:35:20,942 [INFO]   L 8 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 19:36:38,431 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 19:37:57,418 [INFO]   L12 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:39:16,305 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:40:37,879 [INFO]   L12 output_only : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:41:57,529 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:43:19,736 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:44:41,222 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:45:59,731 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:47:19,794 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:48:41,538 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:50:00,103 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:51:20,915 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:52:42,377 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.30 [0.19,0.44]
2026-01-31 19:52:42,378 [INFO] 
============================================================
2026-01-31 19:52:42,378 [INFO] Pair: linear_2x -> length
2026-01-31 19:52:42,378 [INFO] ============================================================
2026-01-31 19:54:04,050 [INFO]   L 8 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 19:55:24,797 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 19:56:44,765 [INFO]   L 8 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 19:58:05,644 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 19:59:25,446 [INFO]   L12 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.02 [0.00,0.10]
2026-01-31 20:00:45,475 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 20:02:05,261 [INFO]   L12 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:03:25,439 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.04 [0.01,0.13]
2026-01-31 20:04:45,948 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:06:06,024 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 20:07:26,060 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:08:47,138 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:10:07,907 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:11:28,607 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=1.00 [0.93,1.00]
2026-01-31 20:12:49,500 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:14:08,869 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.08 [0.03,0.19]
2026-01-31 20:14:08,870 [INFO] 
============================================================
2026-01-31 20:14:08,870 [INFO] Pair: sentiment -> antonym
2026-01-31 20:14:08,870 [INFO] ============================================================
2026-01-31 20:15:29,214 [INFO]   L 8 all_demo    : transfer=0.04 [0.01,0.13] preserve=0.78 [0.65,0.87]
2026-01-31 20:16:49,951 [INFO]   L 8 input_only  : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:18:11,525 [INFO]   L 8 output_only : transfer=0.06 [0.02,0.16] preserve=0.80 [0.67,0.89]
2026-01-31 20:19:29,569 [INFO]   L 8 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:20:50,395 [INFO]   L12 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:22:09,497 [INFO]   L12 input_only  : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:23:29,773 [INFO]   L12 output_only : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:24:50,549 [INFO]   L12 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:26:11,595 [INFO]   L15 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:27:31,314 [INFO]   L15 input_only  : transfer=0.00 [0.00,0.07] preserve=0.96 [0.87,0.99]
2026-01-31 20:28:52,957 [INFO]   L15 output_only : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:30:13,462 [INFO]   L15 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:31:33,923 [INFO]   L17 all_demo    : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:32:54,724 [INFO]   L17 input_only  : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:34:15,634 [INFO]   L17 output_only : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:35:35,586 [INFO]   L17 last_demo   : transfer=0.00 [0.00,0.07] preserve=0.98 [0.90,1.00]
2026-01-31 20:35:35,586 [INFO] 
============================================================
2026-01-31 20:35:35,586 [INFO] SUMMARY: Mean Transfer Rate by Condition (with bootstrap 95% CI)
2026-01-31 20:35:35,586 [INFO] ============================================================
2026-01-31 20:35:36,032 [INFO]   Layer  8, all_demo    : mean=0.167 [0.000, 0.487]
2026-01-31 20:35:36,476 [INFO]   Layer 12, all_demo    : mean=0.043 [0.000, 0.130]
2026-01-31 20:35:36,917 [INFO]   Layer 15, all_demo    : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:37,357 [INFO]   Layer 17, all_demo    : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:37,795 [INFO]   Layer  8, input_only  : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:38,229 [INFO]   Layer 12, input_only  : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:38,666 [INFO]   Layer 15, input_only  : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:39,102 [INFO]   Layer 17, input_only  : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:39,540 [INFO]   Layer  8, output_only : mean=0.167 [0.000, 0.480]
2026-01-31 20:35:39,978 [INFO]   Layer 12, output_only : mean=0.030 [0.000, 0.090]
2026-01-31 20:35:40,412 [INFO]   Layer 15, output_only : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:40,844 [INFO]   Layer 17, output_only : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:41,273 [INFO]   Layer  8, last_demo   : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:41,704 [INFO]   Layer 12, last_demo   : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:42,137 [INFO]   Layer 15, last_demo   : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:42,570 [INFO]   Layer 17, last_demo   : mean=0.000 [0.000, 0.000]
2026-01-31 20:35:42,578 [INFO] 
Results saved to results/exp23
2026-01-31 20:35:42,578 [INFO] Experiment 23 complete: 2026-01-31T20:35:42.578407
Loaded on cuda:3. 28 layers, d_model=3072
