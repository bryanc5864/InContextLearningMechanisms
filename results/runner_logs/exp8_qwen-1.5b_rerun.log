2026-01-31 21:59:50,936 [INFO] Experiment 8: Multi-Position Transplantation
2026-01-31 21:59:50,936 [INFO] Start: 2026-01-31T21:59:50.936483
2026-01-31 22:00:31,120 [INFO] Model: Qwen/Qwen2.5-1.5B-Instruct (28 layers), test_layers=[8, 12, 15, 17]
2026-01-31 22:00:31,121 [INFO] 
============================================================
2026-01-31 22:00:31,121 [INFO] Pair: uppercase → first_letter
2026-01-31 22:00:31,121 [INFO] ============================================================
2026-01-31 22:00:31,121 [INFO] 
  Layer 8:
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:601: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.7` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:606: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.8` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
/home/bcheng/miniconda3/envs/icl/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:623: UserWarning: `do_sample` is set to `False`. However, `top_k` is set to `20` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_k`.
  warnings.warn(
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
2026-01-31 22:00:44,505 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:00:56,431 [INFO]     input_only   ( 15 pos): transfer=0.10 preserve=0.70 
2026-01-31 22:01:08,218 [INFO]     output_only  ( 19 pos): transfer=0.10 preserve=0.00 
2026-01-31 22:01:20,714 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:01:20,715 [INFO] 
  Layer 12:
2026-01-31 22:01:32,536 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:01:44,455 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.40 
2026-01-31 22:01:56,479 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:02:08,545 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:02:08,546 [INFO] 
  Layer 15:
2026-01-31 22:02:20,795 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:02:32,634 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.90 
2026-01-31 22:02:44,363 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:02:56,368 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:02:56,368 [INFO] 
  Layer 17:
2026-01-31 22:03:07,918 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:03:20,466 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.60 
2026-01-31 22:03:32,880 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:03:46,231 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:03:46,231 [INFO] 
============================================================
2026-01-31 22:03:46,232 [INFO] Pair: uppercase → repeat_word
2026-01-31 22:03:46,232 [INFO] ============================================================
2026-01-31 22:03:46,232 [INFO] 
  Layer 8:
2026-01-31 22:03:58,129 [INFO]     all_demo     ( 34 pos): transfer=0.90 preserve=0.00 ***
2026-01-31 22:04:10,391 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.40 
2026-01-31 22:04:22,573 [INFO]     output_only  ( 19 pos): transfer=0.90 preserve=0.00 ***
2026-01-31 22:04:35,315 [INFO]     last_demo    (  7 pos): transfer=0.20 preserve=0.10 
2026-01-31 22:04:35,315 [INFO] 
  Layer 12:
2026-01-31 22:04:48,105 [INFO]     all_demo     ( 34 pos): transfer=0.70 preserve=0.00 ***
2026-01-31 22:04:59,909 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:05:12,607 [INFO]     output_only  ( 19 pos): transfer=0.70 preserve=0.00 ***
2026-01-31 22:05:24,771 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:05:24,772 [INFO] 
  Layer 15:
2026-01-31 22:05:36,999 [INFO]     all_demo     ( 34 pos): transfer=0.50 preserve=0.00 ***
2026-01-31 22:05:48,918 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:06:00,888 [INFO]     output_only  ( 19 pos): transfer=0.50 preserve=0.00 ***
2026-01-31 22:06:12,756 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:06:12,756 [INFO] 
  Layer 17:
2026-01-31 22:06:25,206 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:06:37,350 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:06:48,908 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:07:00,569 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:07:00,569 [INFO] 
============================================================
2026-01-31 22:07:00,569 [INFO] Pair: first_letter → repeat_word
2026-01-31 22:07:00,569 [INFO] ============================================================
2026-01-31 22:07:00,569 [INFO] 
  Layer 8:
2026-01-31 22:07:12,048 [INFO]     all_demo     ( 30 pos): transfer=0.80 preserve=0.00 ***
2026-01-31 22:07:24,171 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:07:35,621 [INFO]     output_only  ( 15 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:07:47,109 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:07:47,109 [INFO] 
  Layer 12:
2026-01-31 22:07:59,348 [INFO]     all_demo     ( 30 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:08:11,367 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:08:23,624 [INFO]     output_only  ( 15 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:08:35,272 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:08:35,272 [INFO] 
  Layer 15:
2026-01-31 22:08:46,781 [INFO]     all_demo     ( 30 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:08:58,264 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:09:11,559 [INFO]     output_only  ( 15 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:09:25,103 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:09:25,103 [INFO] 
  Layer 17:
2026-01-31 22:09:37,790 [INFO]     all_demo     ( 30 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:09:50,111 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:10:03,429 [INFO]     output_only  ( 15 pos): transfer=0.00 preserve=0.40 
2026-01-31 22:10:16,595 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:10:16,595 [INFO] 
============================================================
2026-01-31 22:10:16,595 [INFO] Pair: uppercase → sentiment
2026-01-31 22:10:16,595 [INFO] ============================================================
2026-01-31 22:10:16,596 [INFO] 
  Layer 8:
2026-01-31 22:10:26,471 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:10:38,473 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.50 
2026-01-31 22:10:48,134 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:10:58,457 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:10:58,466 [INFO] 
  Layer 12:
2026-01-31 22:11:10,126 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:11:22,530 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=0.90 
2026-01-31 22:11:35,445 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:11:47,455 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:11:47,455 [INFO] 
  Layer 15:
2026-01-31 22:12:00,488 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.20 
2026-01-31 22:12:13,550 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:12:25,893 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.10 
2026-01-31 22:12:39,176 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:12:39,176 [INFO] 
  Layer 17:
2026-01-31 22:12:52,620 [INFO]     all_demo     ( 34 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:13:05,408 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:13:18,268 [INFO]     output_only  ( 19 pos): transfer=0.00 preserve=0.10 
2026-01-31 22:13:31,467 [INFO]     last_demo    (  7 pos): transfer=0.00 preserve=0.20 
2026-01-31 22:13:31,468 [INFO] 
============================================================
2026-01-31 22:13:31,468 [INFO] Pair: linear_2x → length
2026-01-31 22:13:31,468 [INFO] ============================================================
2026-01-31 22:13:31,468 [INFO] 
  Layer 8:
2026-01-31 22:13:44,009 [INFO]     all_demo     ( 43 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:13:57,245 [INFO]     input_only   ( 20 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:14:09,585 [INFO]     output_only  ( 23 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:14:21,668 [INFO]     last_demo    (  9 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:14:21,669 [INFO] 
  Layer 12:
2026-01-31 22:14:34,235 [INFO]     all_demo     ( 43 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:14:46,583 [INFO]     input_only   ( 20 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:14:59,878 [INFO]     output_only  ( 23 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:15:12,614 [INFO]     last_demo    (  9 pos): transfer=0.00 preserve=0.90 
2026-01-31 22:15:12,614 [INFO] 
  Layer 15:
2026-01-31 22:15:26,140 [INFO]     all_demo     ( 43 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:15:39,466 [INFO]     input_only   ( 20 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:15:52,373 [INFO]     output_only  ( 23 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:16:05,351 [INFO]     last_demo    (  9 pos): transfer=0.00 preserve=0.90 
2026-01-31 22:16:05,351 [INFO] 
  Layer 17:
2026-01-31 22:16:17,803 [INFO]     all_demo     ( 43 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:16:31,540 [INFO]     input_only   ( 20 pos): transfer=0.00 preserve=0.70 
2026-01-31 22:16:44,030 [INFO]     output_only  ( 23 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:16:56,276 [INFO]     last_demo    (  9 pos): transfer=0.00 preserve=0.90 
2026-01-31 22:16:56,277 [INFO] 
============================================================
2026-01-31 22:16:56,277 [INFO] Pair: sentiment → antonym
2026-01-31 22:16:56,277 [INFO] ============================================================
2026-01-31 22:16:56,277 [INFO] 
  Layer 8:
2026-01-31 22:17:09,586 [INFO]     all_demo     ( 30 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:17:22,474 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:17:36,001 [INFO]     output_only  ( 15 pos): transfer=1.00 preserve=0.00 ***
2026-01-31 22:17:49,802 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:17:49,803 [INFO] 
  Layer 12:
2026-01-31 22:18:04,102 [INFO]     all_demo     ( 30 pos): transfer=0.90 preserve=0.00 ***
2026-01-31 22:18:17,683 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:18:31,410 [INFO]     output_only  ( 15 pos): transfer=1.00 preserve=0.00 ***
2026-01-31 22:18:44,378 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:18:44,378 [INFO] 
  Layer 15:
2026-01-31 22:18:57,876 [INFO]     all_demo     ( 30 pos): transfer=1.00 preserve=0.00 ***
2026-01-31 22:19:11,461 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:19:24,406 [INFO]     output_only  ( 15 pos): transfer=0.20 preserve=0.00 
2026-01-31 22:19:36,506 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:19:36,507 [INFO] 
  Layer 17:
2026-01-31 22:19:50,309 [INFO]     all_demo     ( 30 pos): transfer=0.30 preserve=0.00 
2026-01-31 22:20:03,142 [INFO]     input_only   ( 15 pos): transfer=0.00 preserve=1.00 
2026-01-31 22:20:16,665 [INFO]     output_only  ( 15 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:20:30,829 [INFO]     last_demo    (  6 pos): transfer=0.00 preserve=0.00 
2026-01-31 22:20:30,829 [INFO] 
============================================================
2026-01-31 22:20:30,829 [INFO] SUMMARY BY CONDITION
2026-01-31 22:20:30,829 [INFO] ============================================================
2026-01-31 22:20:30,830 [INFO]   Layer  8, all_demo    : mean transfer = 0.283
2026-01-31 22:20:30,830 [INFO]   Layer 12, all_demo    : mean transfer = 0.267
2026-01-31 22:20:30,830 [INFO]   Layer 15, all_demo    : mean transfer = 0.250
2026-01-31 22:20:30,830 [INFO]   Layer 17, all_demo    : mean transfer = 0.050
2026-01-31 22:20:30,830 [INFO]   Layer  8, input_only  : mean transfer = 0.017
2026-01-31 22:20:30,831 [INFO]   Layer 12, input_only  : mean transfer = 0.000
2026-01-31 22:20:30,831 [INFO]   Layer 15, input_only  : mean transfer = 0.000
2026-01-31 22:20:30,831 [INFO]   Layer 17, input_only  : mean transfer = 0.000
2026-01-31 22:20:30,831 [INFO]   Layer  8, output_only : mean transfer = 0.333
2026-01-31 22:20:30,831 [INFO]   Layer 12, output_only : mean transfer = 0.283
2026-01-31 22:20:30,831 [INFO]   Layer 15, output_only : mean transfer = 0.117
2026-01-31 22:20:30,831 [INFO]   Layer 17, output_only : mean transfer = 0.000
2026-01-31 22:20:30,831 [INFO]   Layer  8, last_demo   : mean transfer = 0.033
2026-01-31 22:20:30,831 [INFO]   Layer 12, last_demo   : mean transfer = 0.000
2026-01-31 22:20:30,832 [INFO]   Layer 15, last_demo   : mean transfer = 0.000
2026-01-31 22:20:30,832 [INFO]   Layer 17, last_demo   : mean transfer = 0.000
2026-01-31 22:20:30,836 [INFO] 
Results saved to results/qwen2.5-1.5b-instruct/exp8
2026-01-31 22:20:30,836 [INFO] Experiment 8 complete: 2026-01-31T22:20:30.836179
Note: overriding fp16 -> fp32 for Qwen/Qwen2.5-1.5B-Instruct (fp16 produces NaN)
Loading Qwen/Qwen2.5-1.5B-Instruct (dtype=torch.float32)...
Loaded on cuda:3. 28 layers, d_model=1536
